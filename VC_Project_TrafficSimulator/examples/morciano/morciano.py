from trafficSimulator import *
from trafficSimulator.core.vehicle_loader import load_vehicles

sim = Simulation("VC_Project_TrafficSimulator/examples/morciano/log_morciano_crashes.txt")

interurban_speed_limit = 25.0  # m/s (90 km/h)
urban_speed_limit = 13.8  # m/s (50 km/h)
gravel_speed_limit = 8.3  # m/s (30 km/h)

# Perimeter roads
road_one_1 = Segment(points=((-147.81005,409.9841), (220.12148,-103.77928)), material="asphalt", speed_limit=interurban_speed_limit, identifier="road_one_1")
road_one_2 = Segment(points=((219.62661,-103.08834), (235.12161,-124.73222)), material="asphalt", speed_limit=interurban_speed_limit, identifier="road_one_2")
road_one_3 = Segment(points=((234.9829,-124.49076), (443.19339,-415.1301)), material="asphalt", speed_limit=interurban_speed_limit, identifier="road_one_3")
road_two = Segment(points=((-192.48003,338.31978), (-184.52877,404.73625)), material="asphalt", speed_limit=interurban_speed_limit, identifier="road_two")
road_three_1 = Segment(points=((-218.27632,252.66322), (-211.20437,279.02401)), material="asphalt", speed_limit=interurban_speed_limit, identifier="road_three_1")
road_three_2 = Segment(points=((-211.2605,278.83691), (-199.77458,321.2903)), material="asphalt", speed_limit=interurban_speed_limit, identifier="road_three_2")
road_four_1 = Segment(points=((-235.50559,118.26874), (-234.1033,130.8629)), material="asphalt", speed_limit=interurban_speed_limit, identifier="road_four_1")
road_four_2 = Segment(points=((-234.12976,130.38665), (-230.00226,167.21665)), material="asphalt", speed_limit=interurban_speed_limit, identifier="road_four_2")
road_four_3 = Segment(points=((-230.05518,166.7404), (-222.19705,236.56393)), material="asphalt", speed_limit=interurban_speed_limit, identifier="road_four_3")
road_five_1 = Segment(points=((-233.36247,9.7687649), (-235.58497,58.631659)), material="asphalt", speed_limit=interurban_speed_limit, identifier="road_five_1")
road_five_2 = Segment(points=((-235.47914,57.149993), (-237.27831,96.307219)), material="asphalt", speed_limit=interurban_speed_limit, identifier="road_five_2")
road_six = Segment(points=((-195.97968,-185.91678), (-231.69843,-6.0001332)), material="asphalt", speed_limit=interurban_speed_limit, identifier="road_six")
road_seven_1 = Segment(points=((-63.847388,-361.47214), (-81.676865,-338.66662)), material="asphalt", speed_limit=interurban_speed_limit, identifier="road_seven_1")
road_seven_2 = Segment(points=((-81.147697,-339.35455), (-92.313113,-324.88184)), material="asphalt", speed_limit=interurban_speed_limit, identifier="road_seven_2")
road_seven_3 = Segment(points=((-91.327185,-326.20264), (-191.29639,-198.20687)), material="asphalt", speed_limit=interurban_speed_limit, identifier="road_seven_3")
road_eight_1 = Segment(points=((149.99304,-376.55496), (102.23498,-375.28495)), material="asphalt", speed_limit=interurban_speed_limit, identifier="road_eight_1")
road_eight_2 = Segment(points=((102.92291,-375.31782), (60.801242,-374.20016)), material="asphalt", speed_limit=interurban_speed_limit, identifier="road_eight_2")
road_eight_3 = Segment(points=((61.594993,-374.22662), (-52.517905,-371.26328)), material="asphalt", speed_limit=interurban_speed_limit, identifier="road_eight_3")
road_nine_1 = Segment(points=((431.48245,-431.6412), (302.25996,-406.08246)), material="asphalt", speed_limit=interurban_speed_limit, identifier="road_nine_1")
road_nine_2 = Segment(points=((303.68871,-406.29412), (254.26454,-396.50453)), material="asphalt", speed_limit=interurban_speed_limit, identifier="road_nine_2")
road_nine_3 = Segment(points=((255.79913,-396.82204), (156.22594,-377.15519)), material="asphalt", speed_limit=interurban_speed_limit, identifier="road_nine_3")
sim.add_segment(road_one_1)
sim.add_segment(road_one_2)
sim.add_segment(road_one_3)
sim.add_segment(road_two)
sim.add_segment(road_three_1)
sim.add_segment(road_three_2)
sim.add_segment(road_four_1)
sim.add_segment(road_four_2)
sim.add_segment(road_four_3)
sim.add_segment(road_five_1)
sim.add_segment(road_five_2)
sim.add_segment(road_six)
sim.add_segment(road_seven_1)
sim.add_segment(road_seven_2)
sim.add_segment(road_seven_3)
sim.add_segment(road_eight_1)
sim.add_segment(road_eight_2)
sim.add_segment(road_eight_3)
sim.add_segment(road_nine_1)
sim.add_segment(road_nine_2)
sim.add_segment(road_nine_3)

two_one_curve = CubicCurve((-184.55594,404.44746), (-180.56744,427.58717), (-154.80441,420.93638), (-146.83288,408.75577), material="asphalt", speed_limit=interurban_speed_limit, identifier="two_one_curve")
three_two_curve = CubicCurve((-199.85739,320.98472), (-198.1721,326.8423), (-193.23926,332.44427), (-192.41153,338.94856), material="asphalt", speed_limit=interurban_speed_limit, identifier="three_two_curve")
four_three_curve = CubicCurve((-222.2776,235.91124), (-221.62325,241.64661), (-219.37224,248.37961), (-218.08434,253.35292), material="asphalt", speed_limit=interurban_speed_limit, identifier="four_three_curve")
five_four_curve = CubicCurve((-237.27999,95.635893), (-237.27839,102.66949), (-236.43906,111.85282), (-235.42673,118.88641), material="asphalt", speed_limit=interurban_speed_limit, identifier="five_four_curve")
six_five_curve = CubicCurve((-231.63222,-6.1855599), (-232.5416,-1.5473207), (-233.14429,5.6540696), (-233.40589,10.292309), material="asphalt", speed_limit=interurban_speed_limit, identifier="six_five_curve")
seven_six_curve = CubicCurve((-190.95079,-198.64957), (-193.37556,-195.43996), (-194.91779,-190.55737), (-196.08755,-185.4511), material="asphalt", speed_limit=interurban_speed_limit, identifier="seven_six_curve")
eight_seven_curve = CubicCurve((-52.326357,-371.25404), (-56.742238,-370.88728), (-62.116317,-363.66713), (-64.253258,-360.964), material="asphalt", speed_limit=interurban_speed_limit, identifier="eight_seven_curve")
nine_eight_curve = CubicCurve((157.15446,-377.3344), (156.02395,-377.08609), (151.57502,-376.61106), (149.52904,-376.52132), material="asphalt", speed_limit=interurban_speed_limit, identifier="nine_eight_curve")
nine_one_curve = CubicCurve((443.05578,-414.99959), (452.737,-428.25278), (438.246,-433.10162), (430.31672,-431.44912), material="asphalt", speed_limit=interurban_speed_limit, identifier="nine_one_curve")
sim.add_segment(two_one_curve)
sim.add_segment(three_two_curve)
sim.add_segment(four_three_curve)
sim.add_segment(five_four_curve)
sim.add_segment(six_five_curve)
sim.add_segment(seven_six_curve)
sim.add_segment(eight_seven_curve)
sim.add_segment(nine_eight_curve)
sim.add_segment(nine_one_curve)

# Enterance/Exit roads
enter_road_1_curve = CubicCurve((-150.44434,444.3729), (-150.98709,428.88217), (-153.2342,415.9644), (-146.70417,408.38348), material="asphalt", speed_limit=urban_speed_limit, identifier="enter_road_1_curve")
exit_road_1_curve = CubicCurve((442.35023,-413.90751), (450.0864,-424.15971), (469.04913,-426.17323), (478.65078,-428.61522), material="asphalt", speed_limit=urban_speed_limit, identifier="exit_road_1_curve")
exit_road_3_curve = CubicCurve((-200.0748,320.1649), (-196.41036,331.57843), (-203.40745,338.73199), (-214.837,354.0077), material="asphalt", speed_limit=urban_speed_limit, identifier="exit_road_3_curve")
enter_road_5_curve = CubicCurve((-253.96816,77.121428), (-246.08697,83.213769), (-236.86819,89.885086), (-237.36529,97.350975), material="asphalt", speed_limit=urban_speed_limit, identifier="enter_road_5_curve")
exit_road_6_curve = CubicCurve((-231.41097,-7.6688173), (-233.15037,2.4844187), (-247.05536,12.579631), (-253.39388,15.01568), material="asphalt", speed_limit=urban_speed_limit, identifier="exit_road_6_curve")
enter_road_7_curve = CubicCurve((-62.236943,-394.6679), (-60.218898,-381.46392), (-59.11873,-368.28774), (-64.913583,-360.10442), material="asphalt", speed_limit=urban_speed_limit, identifier="enter_road_7_curve")
exit_road_9_curve = CubicCurve((158.98757,-377.67646), (150.30312,-375.73229), (133.19427,-378.84808), (112.55244,-392.39408), material="asphalt", speed_limit=urban_speed_limit, identifier="exit_road_9_curve")
sim.add_segment(enter_road_1_curve)
sim.add_segment(exit_road_1_curve)
sim.add_segment(exit_road_3_curve)
sim.add_segment(enter_road_5_curve)
sim.add_segment(exit_road_6_curve)
sim.add_segment(enter_road_7_curve)
sim.add_segment(exit_road_9_curve)

# Road 1
i_1_1_north = Segment(points=((-205.15805,19.957952), (0.69298446,-246.00948)), material="asphalt", speed_limit=urban_speed_limit, identifier="i_1_1_north")
i_1_2_north = Segment(points=((25.363231,-278.30255), (81.391326,-350.80101)), material="asphalt", speed_limit=urban_speed_limit, identifier="i_1_2_north")
i_1_1_south = Segment(points=((73.032154,-350.06211), (19.264968,-280.65869)), material="asphalt", speed_limit=urban_speed_limit, identifier="i_1_1_south")
i_1_2_south = Segment(points=((-3.8807128,-250.99897), (-225.42785,36.329709)), material="asphalt", speed_limit=urban_speed_limit, identifier="i_1_2_south")
straight_1_north = Segment(points=((-0.4410126,-244.46799), (26.411755,-279.69999)), material="asphalt", speed_limit=urban_speed_limit, identifier="straight_1_north")
straight_1_south = Segment(points=((20.531586,-282.29708), (-5.145147,-249.36813)), material="asphalt", speed_limit=urban_speed_limit, identifier="straight_1_south")
sim.add_segment(i_1_1_north)
sim.add_segment(i_1_2_north)
sim.add_segment(i_1_1_south)
sim.add_segment(i_1_2_south)
sim.add_segment(straight_1_north)
sim.add_segment(straight_1_south)

from_1_north_curve = CubicCurve((80.697921,-349.88291), (90.735228,-361.95124), (76.50592,-375.4084), (60.964709,-374.18658), material="asphalt", speed_limit=urban_speed_limit, identifier="from_1_north_curve")
from_1_south_curve = CubicCurve((-224.01588,34.501963), (-229.00926,40.919728), (-235.0729,48.588741), (-235.57141,58.392602), material="asphalt", speed_limit=urban_speed_limit, identifier="from_1_south_curve")
to_1_north_curve = CubicCurve((-233.43129,11.939017), (-234.39991,32.958966), (-211.63967,28.983991), (-204.62985,19.233049), material="asphalt", speed_limit=urban_speed_limit, identifier="to_1_north_curve")
to_1_south_curve = CubicCurve((102.79509,-375.26505), (91.506623,-374.99066), (80.407302,-359.98287), (72.250823,-349.03351), material="asphalt", speed_limit=urban_speed_limit, identifier="to_1_south_curve")
sim.add_segment(from_1_north_curve)
sim.add_segment(from_1_south_curve)
sim.add_segment(to_1_north_curve)
sim.add_segment(to_1_south_curve)


from_2_north_curve = CubicCurve((-72.867315,-325.6334), (-80.272271,-330.92678), (-86.303503,-332.27936), (-92.374827,-324.87111), material="asphalt", speed_limit=urban_speed_limit, identifier="from_2_north_curve")
from_2_south_curve = CubicCurve((212.07806,-122.06249), (218.03617,-117.83882), (229.83951,-117.24257), (235.20672,-124.80657), material="asphalt", speed_limit=urban_speed_limit, identifier="from_2_south_curve")
to_2_north_curve = CubicCurve((219.29493,-102.56171), (225.27461,-110.47498), (224.101,-120.65701), (215.37957,-126.60826), material="asphalt", speed_limit=urban_speed_limit, identifier="to_2_north_curve")
to_2_south_curve = CubicCurve((-81.342325,-339.0897), (-87.843202,-330.89506), (-81.177415,-323.89685), (-74.84964,-319.93016), material="asphalt", speed_limit=urban_speed_limit, identifier="to_2_south_curve")
sim.add_segment(from_2_north_curve)
sim.add_segment(from_2_south_curve)
sim.add_segment(to_2_north_curve)
sim.add_segment(to_2_south_curve)

# Road 1-2
left_1_curve = CubicCurve((20.090575,-281.75804), (5.2510591,-263.25941), (6.9606059,-263.78361), (28.469815,-248.78011), material="asphalt", speed_limit=urban_speed_limit, identifier="left_1_curve")
left_2_curve = CubicCurve((-10.459037,-275.50269), (10.832219,-260.94558), (10.714854,-259.19035), (25.871719,-278.98323), material="asphalt", speed_limit=urban_speed_limit, identifier="left_2_curve")
left_3_curve = CubicCurve((0.29400848,-245.44802), (15.642234,-265.74797), (15.81617,-264.46462), (-7.2240129,-280.19001), material="asphalt", speed_limit=urban_speed_limit, identifier="left_3_curve")
left_4_curve = CubicCurve((31.826842,-253.46993), (8.0570946,-269.689), (9.3205872,-267.8953), (-4.5484754,-250.15202), material="asphalt", speed_limit=urban_speed_limit, identifier="left_4_curve")
right_1_curve = CubicCurve((19.723063,-281.24354), (8.2386303,-265.9184), (9.206663,-268.69422), (-6.9581986,-280.04302), material="asphalt", speed_limit=urban_speed_limit, identifier="right_1_curve")
right_2_curve = CubicCurve((-9.6527805,-274.97203), (6.0108344,-263.94717), (7.1038899,-265.51092), (-4.3489875,-250.38021), material="asphalt", speed_limit=urban_speed_limit, identifier="right_2_curve")
right_3_curve = CubicCurve((-0.00348238,-245.10512), (12.173428,-260.68668), (9.0838922,-262.00368), (28.3654,-248.84375), material="asphalt", speed_limit=urban_speed_limit, identifier="right_3_curve")
right_4_curve = CubicCurve((33.124657,-252.52353), (15.918922,-264.89299), (13.991238,-262.91602), (26.056214,-279.27273), material="asphalt", speed_limit=urban_speed_limit, identifier="right_4_curve")
sim.add_segment(left_1_curve)
sim.add_segment(left_2_curve)
sim.add_segment(left_3_curve)
sim.add_segment(left_4_curve)
sim.add_segment(right_1_curve)
sim.add_segment(right_2_curve)
sim.add_segment(right_3_curve)
sim.add_segment(right_4_curve)

# Road 3
i_3_1_north = Segment(points=((-169.54485,183.36325), (-208.05995,154.64842)), material="gravel", speed_limit=gravel_speed_limit, identifier="i_3_1_north")
i_3_1_south = Segment(points=((-209.628,160.52859), (-172.97495,187.87137)), material="gravel", speed_limit=gravel_speed_limit, identifier="i_3_1_south")
sim.add_segment(i_3_1_north)
sim.add_segment(i_3_1_south)

from_3_north_curve = CubicCurve((-206.83492,155.53045), (-217.41943,147.56352), (-232.30175,145.76183), (-229.96358,167.58479), material="gravel", speed_limit=gravel_speed_limit, identifier="from_3_north_curve")
to_3_south_curve = CubicCurve((-234.19656,130.06826), (-232.50559,144.77686), (-219.89177,152.96827), (-208.0116,161.7565), material="gravel", speed_limit=gravel_speed_limit, identifier="to_3_south_curve")
sim.add_segment(from_3_north_curve)
sim.add_segment(to_3_south_curve)

# Road 4
i_4_1_north = Segment(points=((-198.12426,261.18584), (-165.41539,216.56113)), material="asphalt", speed_limit=urban_speed_limit, identifier="i_4_1_north")
i_4_2_north = Segment(points=((-140.21946,182.01832), (274.64669,-384.92519)), material="asphalt", speed_limit=urban_speed_limit, identifier="i_4_2_north")
i_4_1_south = Segment(points=((271.50529,-390.04047), (-144.92335,178.78999)), material="asphalt", speed_limit=urban_speed_limit, identifier="i_4_1_south")
i_4_2_south = Segment(points=((-169.63419,212.69723), (-199.92602,253.9095)), material="asphalt", speed_limit=urban_speed_limit, identifier="i_4_2_south")
straight_4_north = Segment(points=((-166.45343,217.96174), (-139.02181,180.38877)), material="asphalt", speed_limit=urban_speed_limit, identifier="straight_4_north")
straight_4_south = Segment(points=((-143.76557,177.22483), (-170.72615,214.17976)), material="asphalt", speed_limit=urban_speed_limit, identifier="straight_4_south")
sim.add_segment(i_4_1_north)
sim.add_segment(i_4_2_north)
sim.add_segment(i_4_1_south)
sim.add_segment(i_4_2_south)
sim.add_segment(straight_4_north)
sim.add_segment(straight_4_south)

from_4_north_curve = CubicCurve((273.47682,-383.33795), (284.34991,-397.25562), (262.43968,-398.14397), (254.90529,-396.69085), material="asphalt", speed_limit=urban_speed_limit, identifier="from_4_north_curve")
from_4_south_curve = CubicCurve((-199.14488,252.82913), (-204.93446,261.19422), (-213.30193,271.878), (-211.21326,278.92348), material="asphalt", speed_limit=urban_speed_limit, identifier="from_4_south_curve")
to_4_north_curve = CubicCurve((-218.69401,251.11235), (-215.4672,263.26495), (-203.34414,269.68177), (-196.89972,259.50892), material="asphalt", speed_limit=urban_speed_limit, identifier="to_4_north_curve")
to_4_south_curve = CubicCurve((303.76974,-406.36607), (284.73404,-402.57771), (277.27938,-397.92108), (270.50647,-388.69498), material="asphalt", speed_limit=urban_speed_limit, identifier="to_4_south_curve")
sim.add_segment(from_4_north_curve)
sim.add_segment(from_4_south_curve)
sim.add_segment(to_4_north_curve)
sim.add_segment(to_4_south_curve)

# Road 3-4
left_5_curve = CubicCurve((-174.49349,186.75931), (-157.05562,199.84405), (-153.2362,199.8691), (-139.31438,180.77514), material="asphalt", speed_limit=urban_speed_limit, identifier="left_5_curve")
left_6_curve = CubicCurve((-166.38556,217.87431), (-152.56099,198.8033), (-153.23651,195.03445), (-170.95926,182.32421), material="asphalt", speed_limit=urban_speed_limit, identifier="left_6_curve")
right_5_curve = CubicCurve((-144.2031,177.7663), (-155.37753,192.90819), (-156.49163,193.00392), (-170.84793,182.41874), material="asphalt", speed_limit=urban_speed_limit, identifier="right_5_curve")
right_6_curve = CubicCurve((-174.02725,187.10724), (-159.61859,197.71309), (-160.42823,199.80427), (-170.92215,214.42621), material="asphalt", speed_limit=urban_speed_limit, identifier="right_6_curve")
sim.add_segment(left_5_curve)
sim.add_segment(left_6_curve)
sim.add_segment(right_5_curve)
sim.add_segment(right_6_curve)

# Road 2
i_2_1_north = Segment(points=((216.74782,-125.61782), (144.88666,-175.44514)), material="asphalt", speed_limit=urban_speed_limit, identifier="i_2_1_north")
i_2_2_north = Segment(points=((113.85453,-196.85342), (31.062946,-253.98591)), material="asphalt", speed_limit=urban_speed_limit, identifier="i_2_2_north")
i_2_3_north = Segment(points=((-6.0447683,-279.38936), (-74.219646,-326.56233)), material="asphalt", speed_limit=urban_speed_limit, identifier="i_2_3_north")
i_2_1_south = Segment(points=((-77.242002,-321.58633), (-9.0121781,-274.51833)), material="asphalt", speed_limit=urban_speed_limit, identifier="i_2_1_south")
i_2_2_south = Segment(points=((27.583847,-249.37977), (110.53084,-192.12057)), material="asphalt", speed_limit=urban_speed_limit, identifier="i_2_2_south")
i_2_3_south = Segment(points=((141.39826,-170.61014), (213.34397,-121.23271)), material="asphalt", speed_limit=urban_speed_limit, identifier="i_2_3_south")
straight_2_north = Segment(points=((32.389927,-253.04324), (-8.3792395,-280.97403)), material="asphalt", speed_limit=urban_speed_limit, identifier="straight_2_north")
straight_2_south = Segment(points=((-10.927312,-275.87789), (29.743851,-247.89809)), material="asphalt", speed_limit=urban_speed_limit, identifier="straight_2_south")
bridge_2_north = Segment(points=((146.93792,-174.01188), (111.98485,-198.14948)), material="concrete", speed_limit=urban_speed_limit, identifier="bridge_2_north")
bridge_2_south = Segment(points=((108.63634,-193.44378), (143.34441,-169.25718)), material="concrete", speed_limit=urban_speed_limit, identifier="bridge_2_south")
sim.add_segment(i_2_1_north)
sim.add_segment(i_2_2_north)
sim.add_segment(i_2_3_north)
sim.add_segment(i_2_1_south)
sim.add_segment(i_2_2_south)
sim.add_segment(i_2_3_south)
sim.add_segment(straight_2_north)
sim.add_segment(straight_2_south)
sim.add_segment(bridge_2_north)
sim.add_segment(bridge_2_south)

vehicle_rate, vehicles = load_vehicles("VC_Project_TrafficSimulator/examples/morciano/vehicles_config/config.json", sim)
vg = VehicleGenerator({
    'vehicle_rate': vehicle_rate,
    'vehicles': vehicles
})

sim.add_vehicle_generator(vg)

win = Window(sim)
win.run()
win.show()